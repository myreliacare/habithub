<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Our Life Together</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&family=Philosopher:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            width: 100%;
            touch-action: pan-y;
            background: #3d2f31;
        }

        body {
            font-family: 'Philosopher', Georgia, serif;
            background: #3d2f31 !important;
            min-height: 100vh;
            padding: 80px 16px 16px 16px;
            color: #4a3a3c;
            position: relative;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .btn {
            background: transparent;
            border: 1px solid #d4b5b8;
            color: #7a6668;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            font-family: inherit;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background: #b59197;
            color: #4a3a3c;
            border-color: #b59197;
        }

        .page-header {
            text-align: center;
            margin-bottom: 32px;
            margin-top: 24px;
        }

        .page-title {
            font-family: 'Dancing Script', cursive;
            background: linear-gradient(135deg, #b59197 0%, #7ba886 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2.8rem;
            font-weight: 400;
            letter-spacing: 0.02em;
            margin-bottom: 8px;
        }

        .page-subtitle {
            color: #7a6668;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
            font-style: italic;
        }

        .section-nav-dropdown {
            margin-bottom: 20px;
            text-align: center;
        }

        #sectionSelect {
            width: auto;
            background: #EBE0D6;
            border: 1px solid #7ba886;
            color: #7ba886;
            padding: 8px 12px;
            font-size: 0.85rem;
            cursor: pointer;
            font-family: inherit;
            font-weight: 500;
            letter-spacing: 0.05em;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%237ba886' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 14px;
            padding-right: 30px;
        }

        #sectionSelect:hover {
            background-color: #333;
            border-color: #b59197;
        }

        #sectionSelect:focus {
            outline: none;
            border-color: #b59197;
        }

        #sectionSelect option {
            background: #EBE0D6;
            color: #4a3a3c;
            padding: 8px;
        }

        .dreams-tab {
            display: none;
        }

        .dreams-tab.active {
            display: block;
        }

        .section {
            background: #EBE0D6;
            border: 1px solid #b59197;
            padding: 24px;
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 0.75rem;
            font-weight: 400;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: #b59197;
            margin-bottom: 20px;
        }

        .dream-list {
            margin-bottom: 16px;
        }

        .dream-list-toggle {
            background: #EBE0D6;
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #d4b5b8;
            margin-bottom: 0;
            transition: background 0.2s;
        }

        .dream-list-toggle:hover {
            background: #252525;
        }

        .dream-list-toggle-text {
            color: #7ba886;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 500;
        }

        .dream-list-arrow {
            color: #7a6668;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .dream-list.expanded .dream-list-arrow {
            transform: rotate(180deg);
        }

        .dream-list-content {
            display: none;
            padding-top: 12px;
        }

        .dream-list.expanded .dream-list-content {
            display: block;
        }

        .dream-item {
            background: #EBE0D6;
            padding: 12px 14px;
            margin-bottom: 2px;
            border-left: 3px solid #b59197;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: background 0.15s;
        }

        .dream-item:hover {
            background: #e3d6cc;
        }

        .dream-item.achieved {
            opacity: 0.5;
            border-left-color: #7ba886;
        }

        .dream-item-content {
            flex: 1;
            min-width: 0;
        }

        .dream-item-title {
            color: #4a3a3c;
            font-size: 0.9rem;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .dream-item.achieved .dream-item-title {
            text-decoration: line-through;
        }

        .dream-item-indicators {
            display: flex;
            align-items: center;
            gap: 6px;
            flex-shrink: 0;
        }

        .indicator-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .indicator-dot.high { background: #ff9999; }
        .indicator-dot.soon { background: #ffcc99; }
        .indicator-dot.has-image { background: #b59197; }

        .dream-item-chevron {
            color: #b59197;
            font-size: 0.7rem;
            flex-shrink: 0;
            opacity: 0.5;
        }

        /* Detail Popup */
        .detail-popup {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .detail-popup.active { display: flex; }
        .detail-popup-box {
            background: #EBE0D6;
            padding: 24px 20px;
            border: 1px solid #b59197;
            width: 100%;
            max-width: 460px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }
        .detail-popup-close {
            float: right;
            background: none;
            border: none;
            font-size: 1.3rem;
            color: #7a6668;
            cursor: pointer;
            padding: 0 4px;
            line-height: 1;
        }
        .detail-popup-close:hover { color: #4a3a3c; }
        .detail-popup-title {
            font-size: 1.15rem;
            font-weight: 600;
            color: #4a3a3c;
            margin-bottom: 10px;
            padding-right: 24px;
        }
        .detail-popup-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 12px;
        }
        .detail-popup-details {
            color: #5a4a4c;
            font-size: 0.88rem;
            line-height: 1.6;
            margin-bottom: 14px;
        }
        .detail-popup-image {
            width: 100%;
            border: 1px solid #d4b5b8;
            margin-bottom: 14px;
            cursor: pointer;
        }
        .detail-popup-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .detail-popup-actions .icon-btn {
            flex: 1;
            min-width: 80px;
            text-align: center;
        }

        .image-upload-preview {
            max-width: 200px;
            margin-top: 10px;
            border: 1px solid #d4b5b8;
        }

        .image-upload-label {
            display: inline-block;
            background: transparent;
            border: 1px solid #d4b5b8;
            color: #7a6668;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            font-family: inherit;
            margin-top: 6px;
        }

        .image-upload-label:hover {
            background: #b59197;
            color: #4a3a3c;
            border-color: #b59197;
        }

        .image-upload-input {
            display: none;
        }

        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .lightbox.show {
            display: flex;
        }

        .lightbox-image {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }

        .lightbox-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: #4a3a3c;
            font-size: 2rem;
            cursor: pointer;
            background: none;
            border: none;
            padding: 10px;
        }

        .dream-item-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .dream-tag {
            background: #E0D5CB;
            color: #b59197;
            padding: 4px 10px;
            font-size: 0.7rem;
            border: 1px solid #d4b5b8;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .dream-tag.priority-high {
            background: #4a2a2a;
            color: #ff9999;
            border-color: #ff9999;
        }

        .dream-tag.priority-soon {
            background: #3a3a2a;
            color: #ffcc99;
            border-color: #ffcc99;
        }

        .dream-tag.priority-friends {
            background: #2a3a3a;
            color: #99ccff;
            border-color: #99ccff;
        }

        .dream-tag.occasion-date-night {
            background: #3a2a3a;
            color: #ffb3d9;
            border-color: #ffb3d9;
        }

        .dream-tag.occasion-friends {
            background: #2a3a3a;
            color: #99ccff;
            border-color: #99ccff;
        }

        .dream-tag.occasion-special {
            background: #3a3a2a;
            color: #ffd699;
            border-color: #ffd699;
        }

        .dream-item-actions {
            display: flex;
            gap: 6px;
            flex-direction: column;
        }

        .icon-btn {
            background: transparent;
            border: 1px solid #d4b5b8;
            color: #7a6668;
            padding: 6px 10px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.2s ease;
            font-family: inherit;
            min-width: 60px;
            position: relative;
        }

        .icon-btn.saving {
            pointer-events: none;
            color: transparent;
            border-color: #7ba886;
        }

        .icon-btn.saving::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 12px;
            height: 12px;
            margin: -6px 0 0 -6px;
            border: 2px solid rgba(123, 168, 134, 0.3);
            border-top-color: #7ba886;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }

        .icon-btn:hover {
            background: #7ba886;
            color: #4a3a3c;
            border-color: #7ba886;
        }

        .icon-btn.achieved {
            border-color: #7ba886;
            color: #7ba886;
        }

        .icon-btn.achieved:hover {
            background: #7ba886;
            color: #4a3a3c;
        }

        /* Tried It Modal */
        .tried-modal {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .tried-modal.active { display: flex; }
        .tried-modal-box {
            background: #EBE0D6;
            padding: 28px 24px;
            border: 1px solid #b59197;
            width: 100%;
            max-width: 380px;
            text-align: center;
        }
        .tried-modal-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #4a3a3c;
            margin-bottom: 6px;
        }
        .tried-modal-name {
            font-size: 0.95rem;
            color: #7ba886;
            margin-bottom: 20px;
            font-style: italic;
        }
        .tried-modal-buttons {
            display: flex;
            gap: 10px;
        }
        .tried-modal-buttons button {
            flex: 1;
            padding: 10px 12px;
            font-size: 0.85rem;
            font-family: inherit;
            font-weight: 500;
            cursor: pointer;
            border: 1px solid;
            background: transparent;
            transition: all 0.2s;
        }
        .tried-btn-again {
            border-color: #7ba886 !important;
            color: #7ba886;
        }
        .tried-btn-again:hover { background: #7ba886; color: #fff; }
        .tried-btn-pass {
            border-color: #b59197 !important;
            color: #b59197;
        }
        .tried-btn-pass:hover { background: #b59197; color: #fff; }
        .tried-btn-cancel {
            border-color: #999 !important;
            color: #999;
        }
        .tried-btn-cancel:hover { background: #999; color: #fff; }

        /* Section divider */
        .section-divider {
            border: none;
            border-top: 1px solid rgba(123, 168, 134, 0.3);
            margin: 28px 0 20px;
        }

        .add-dream-btn {
            width: 100%;
            background: transparent;
            border: 1px solid #d4b5b8;
            color: #7a6668;
            padding: 10px;
            cursor: pointer;
            font-size: 0.82rem;
            transition: all 0.2s ease;
            font-family: inherit;
            margin-top: 6px;
        }

        .add-dream-btn:hover {
            background: #b59197;
            color: #4a3a3c;
            border-color: #b59197;
        }

        .dream-form {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .dream-form.active {
            display: flex;
        }

        .dream-form form {
            background: #EBE0D6;
            padding: 28px 24px;
            border: 1px solid #b59197;
            width: 100%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-group label {
            display: block;
            color: #7a6668;
            font-size: 0.8rem;
            margin-bottom: 5px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            background: #EBE0D6;
            border: 1px solid #d4b5b8;
            color: #4a3a3c;
            padding: 9px 10px;
            font-size: 0.88rem;
            font-family: inherit;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 60px;
        }

        .form-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #7ba886;
        }

        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-top: 8px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 0.82rem;
            text-transform: none;
            color: #4a3a3c;
            padding: 6px 8px;
            background: #EBE0D6;
            border: 1px solid #d4b5b8;
            transition: all 0.2s ease;
        }

        .checkbox-label:hover {
            background: #252525;
            border-color: #7ba886;
        }

        .checkbox-label input[type="checkbox"]:checked + span {
            color: #7ba886;
            font-weight: 600;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .form-actions .save-btn {
            border: 1px solid #b59197;
            color: #b59197;
            background: transparent;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            font-family: inherit;
            position: relative;
            min-width: 70px;
        }

        .form-actions .save-btn:hover {
            background: #b59197;
            color: #4a3a3c;
        }

        .form-actions .save-btn.saving {
            pointer-events: none;
            color: transparent;
            border-color: #7ba886;
            background: rgba(123, 168, 134, 0.1);
        }

        .form-actions .save-btn.saving::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 16px;
            height: 16px;
            margin: -8px 0 0 -8px;
            border: 2px solid rgba(123, 168, 134, 0.3);
            border-top-color: #7ba886;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .save-success {
            text-align: center;
            color: #7ba886;
            font-size: 0.85rem;
            padding: 10px;
            opacity: 0;
            transition: opacity 0.3s ease;
            font-style: italic;
        }

        .save-success.visible {
            opacity: 1;
        }

        .empty-state {
            text-align: center;
            color: #5a4a4c;
            padding: 40px 20px;
            font-style: italic;
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #EBE0D6;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
            text-align: center;
            display: none;
            z-index: 1000;
            border: 2px solid #b59197;
            max-width: 90%;
        }

        .random-choice {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #EBE0D6;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
            text-align: center;
            display: none;
            z-index: 1000;
            border: 2px solid #7ba886;
            max-width: 90%;
            min-width: 300px;
        }

        .random-choice.show {
            display: block;
        }

        .random-choice h2 {
            background: linear-gradient(135deg, #7ba886 0%, #b59197 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: 0.1em;
        }

        .random-choice-title {
            color: #4a3a3c;
            font-size: 1.8rem;
            margin-bottom: 16px;
            font-weight: 600;
        }

        .random-choice-details {
            color: #7a6668;
            margin-bottom: 24px;
            line-height: 1.6;
            font-size: 1rem;
        }

        .random-choice-image {
            max-width: 100%;
            max-height: 300px;
            margin-bottom: 20px;
            border: 1px solid #d4b5b8;
        }

        .random-choice-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .celebration.show {
            display: block;
        }

        .celebration h2 {
            background: linear-gradient(135deg, #b59197 0%, #7ba886 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 12px;
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: 0.1em;
        }

        .celebration p {
            color: #7a6668;
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: confetti-fall 3s linear forwards;
            z-index: 9999;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .detail-popup-actions {
                flex-direction: row;
            }
            .detail-popup-actions .icon-btn {
                font-size: 0.72rem;
                padding: 8px 6px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 80px 12px 12px 12px;
            }

            .page-title {
                font-size: 2rem;
            }

            .dream-form {
                padding: 12px;
            }

            .dream-form form {
                padding: 20px 16px;
                max-height: 85vh;
            }

            .checkbox-grid {
                gap: 6px;
            }

            .checkbox-label {
                padding: 5px 6px;
                font-size: 0.78rem;
            }
        }

        /* ===== NAV BAR ===== */
        .top-nav {
            position: fixed;
            top: 0; left: 0; right: 0;
            background: #2a1f21;
            border-bottom: 1px solid rgba(163, 184, 153, 0.2);
            z-index: 9999;
            padding: 0 24px;
            font-family: 'Philosopher', Georgia, serif;
        }
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 56px;
        }
        .nav-logo {
            font-size: 1.1rem;
            font-weight: 700;
            color: #a3b899;
            text-decoration: none;
            white-space: nowrap;
        }
        .nav-links { display: flex; gap: 28px; align-items: center; }
        .nav-link {
            color: rgba(242, 235, 224, 0.6);
            text-decoration: none;
            font-size: 0.88rem;
            font-weight: 500;
            white-space: nowrap;
            transition: color 0.2s;
        }
        .nav-link:hover { color: #f2ebe0; }
        .nav-link.active { color: #a3b899; }
        .nav-hamburger {
            display: none;
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            z-index: 10001;
        }
        .nav-hamburger span {
            display: block; width: 24px; height: 2px;
            background: #a3b899; margin: 5px 0;
            transition: all 0.3s ease;
        }
        .nav-hamburger.open span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
        .nav-hamburger.open span:nth-child(2) { opacity: 0; }
        .nav-hamburger.open span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }
        .nav-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: #2a1f21;
            z-index: 10000;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0;
        }
        .nav-overlay.open { display: flex; }
        .nav-link-mobile {
            color: rgba(242, 235, 224, 0.7);
            text-decoration: none;
            font-size: 1.05rem;
            font-family: 'Philosopher', Georgia, serif;
            font-weight: 500;
            padding: 12px 40px;
            transition: color 0.2s;
            display: block;
            width: 100%;
            text-align: center;
        }
        .nav-link-mobile:hover { color: #f2ebe0; }
        .nav-link-mobile.active { color: #a3b899; }
        @media (max-width: 768px) {
            .nav-hamburger { display: block; }
            .nav-links { display: none; }
        }
    </style>
</head>
<body>
    <nav class="top-nav">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">Our Life Hub</a>
            <div class="nav-links">
                <a href="index.html" class="nav-link">Home</a>
                <a href="kasey-hub.html" class="nav-link">Kasey</a>
                <a href="charlie-hub.html" class="nav-link">Charlie</a>
                <a href="our-dreams.html" class="nav-link active">Us ♡</a>
                <a href="meal-plan.html" class="nav-link">Meals</a>
                <a href="settings.html" class="nav-link">Settings</a>
            </div>
            <button class="nav-hamburger" id="navHamburger" onclick="toggleNav()" aria-label="Menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>
    <div class="nav-overlay" id="navOverlay" onclick="toggleNav()">
        <a href="index.html" class="nav-link-mobile">Home</a>
        <a href="kasey-hub.html" class="nav-link-mobile">Kasey</a>
        <a href="charlie-hub.html" class="nav-link-mobile">Charlie</a>
        <a href="our-dreams.html" class="nav-link-mobile active">Us ♡</a>
        <a href="meal-plan.html" class="nav-link-mobile">Meals</a>
        <a href="settings.html" class="nav-link-mobile">Settings</a>
    </div>
    
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">Our Life Together</h1>
            <p class="page-subtitle">Dreams, goals, ideas & all the things we want to do</p>
        </div>

        <div class="section-nav-dropdown">
            <select id="sectionSelect" onchange="switchToSection(this.value)">
                <option value="restaurants">Restaurants</option>
                <option value="places">Places to Go</option>
                <option value="wishlists">Wishlists</option>
                <option value="travel">Travel</option>
                <option value="shows-movies">TV Shows & Movies</option>
                <option value="bucket">Bucket List</option>
                <option value="home">Dream Home</option>
                <option value="pets">Future Pets</option>
                <option value="traditions">Traditions</option>
            </select>
        </div>

        <!-- RESTAURANTS TAB -->
        <div id="restaurants-tab" class="dreams-tab active">
            <div class="section">
                <h2 class="section-title">Restaurants We Want to Try</h2>
                
                <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                    <button class="add-dream-btn" onclick="showForm('restaurants')" style="flex: 1;">+ Add Restaurant</button>
                    <button class="add-dream-btn" onclick="chooseRandomDream('restaurants')" style="flex: 1; border: 2px solid #7ba886; color: #7ba886; background: transparent;">Choose for Us</button>
                </div>
                
                <div class="dream-form" id="restaurants-form">
                    <form data-category="restaurants">
                        <div class="form-group">
                            <label>Restaurant Name</label>
                            <input type="text" name="title" required placeholder="Name of the place">
                        </div>
                        <div class="form-group">
                            <label>Type (Select all that apply)</label>
                            <div class="checkbox-grid">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="restaurantType" value="breakfast">
                                    <span>Breakfast</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="restaurantType" value="brunch">
                                    <span>Brunch</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="restaurantType" value="lunch">
                                    <span>Lunch</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="restaurantType" value="dinner">
                                    <span>Dinner</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="restaurantType" value="cafe">
                                    <span>Cafe</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="restaurantType" value="bar">
                                    <span>Bar</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="restaurantType" value="bakery">
                                    <span>Bakery</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="restaurantType" value="dessert">
                                    <span>Dessert</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Location & Details</label>
                            <textarea name="details" placeholder="Where is it? What kind of food? What do you want to try?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="restaurants-image" accept="image/*" onchange="previewImage(event, 'restaurants')">
                            <label for="restaurants-image" class="image-upload-label">Choose Image</label>
                            <div id="restaurants-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Occasion</label>
                            <select name="occasion">
                                <option value="">Casual</option>
                                <option value="date-night">Date Night</option>
                                <option value="friends">Go with Friends</option>
                                <option value="special">Special Occasion</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">I'd Like to Try</option>
                                <option value="soon">I'd Love to Try</option>
                                <option value="high">We Have to Go!</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('restaurants')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="restaurants-list">
                    <div class="empty-state">No restaurants yet. Where should you go for date night?</div>
                </div>

                <hr class="section-divider">

                <!-- OUR RESTAURANTS -->
                <h2 class="section-title">Our Restaurants ♡</h2>
                <p style="font-size: 0.8rem; color: rgba(74,58,60,0.5); margin-bottom: 12px;">Places we love and would go back to</p>
                
                <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                    <button class="add-dream-btn" onclick="showForm('our-restaurants')" style="flex: 1;">+ Add a Favorite</button>
                    <button class="add-dream-btn" onclick="chooseRandomDream('our-restaurants')" style="flex: 1; border: 2px solid #7ba886; color: #7ba886; background: transparent;">Choose for Us</button>
                </div>

                <div class="dream-form" id="our-restaurants-form">
                    <form data-category="our-restaurants">
                        <div class="form-group">
                            <label>Restaurant Name</label>
                            <input type="text" name="title" required placeholder="Name of the place">
                        </div>
                        <div class="form-group">
                            <label>Type (Select all that apply)</label>
                            <div class="checkbox-grid">
                                <label class="checkbox-label"><input type="checkbox" name="restaurantType" value="breakfast"><span>Breakfast</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="restaurantType" value="brunch"><span>Brunch</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="restaurantType" value="lunch"><span>Lunch</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="restaurantType" value="dinner"><span>Dinner</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="restaurantType" value="cafe"><span>Cafe</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="restaurantType" value="bar"><span>Bar</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="restaurantType" value="bakery"><span>Bakery</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="restaurantType" value="dessert"><span>Dessert</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Location & Details</label>
                            <textarea name="details" placeholder="Where is it? What do we love about it?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="our-restaurants-image" accept="image/*" onchange="previewImage(event, 'our-restaurants')">
                            <label for="our-restaurants-image" class="image-upload-label">Choose Image</label>
                            <div id="our-restaurants-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Occasion</label>
                            <select name="occasion">
                                <option value="">Casual</option>
                                <option value="date-night">Date Night</option>
                                <option value="friends">Go with Friends</option>
                                <option value="special">Special Occasion</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('our-restaurants')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="our-restaurants-list">
                    <div class="empty-state">No favorites yet!</div>
                </div>
            </div>
        </div>

        <!-- PLACES TAB -->
        <div id="places-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Places We Want to Go</h2>
                
                <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                    <button class="add-dream-btn" onclick="showForm('places')" style="flex: 1;">+ Add Place</button>
                    <button class="add-dream-btn" onclick="chooseRandomDream('places')" style="flex: 1; border: 2px solid #7ba886; color: #7ba886; background: transparent;">Choose for Us</button>
                </div>
                
                <div class="dream-form" id="places-form">
                    <form data-category="places">
                        <div class="form-group">
                            <label>Place Name</label>
                            <input type="text" name="title" required placeholder="Where do you want to go?">
                        </div>
                        <div class="form-group">
                            <label>Type (Select all that apply)</label>
                            <div class="checkbox-grid">
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="museum"><span>Museum</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="park"><span>Park</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="thrift-shop"><span>Thrift Shop</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="metaphysical-shop"><span>Metaphysical Shop</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="bookstore"><span>Bookstore</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="concert"><span>Concert</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="festival"><span>Festival</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="market"><span>Market</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="nature"><span>Nature Spot</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="entertainment"><span>Entertainment</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="historic"><span>Historic Site</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="details" placeholder="What is it? What do you want to do there?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="places-image" accept="image/*" onchange="previewImage(event, 'places')">
                            <label for="places-image" class="image-upload-label">Choose Image</label>
                            <div id="places-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">I'd Like to Go</option>
                                <option value="soon">I'd Love to Go</option>
                                <option value="high">We Have to Go!</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('places')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="places-list">
                    <div class="empty-state">No places yet. Where do you want to go?</div>
                </div>

                <hr class="section-divider">

                <h2 class="section-title">Our Places ♡</h2>
                <p style="font-size: 0.8rem; color: rgba(74,58,60,0.5); margin-bottom: 12px;">Spots we love and would go back to</p>

                <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                    <button class="add-dream-btn" onclick="showForm('our-places')" style="flex: 1;">+ Add a Favorite</button>
                    <button class="add-dream-btn" onclick="chooseRandomDream('our-places')" style="flex: 1; border: 2px solid #7ba886; color: #7ba886; background: transparent;">Choose for Us</button>
                </div>

                <div class="dream-form" id="our-places-form">
                    <form data-category="our-places">
                        <div class="form-group">
                            <label>Place Name</label>
                            <input type="text" name="title" required placeholder="Name of the place">
                        </div>
                        <div class="form-group">
                            <label>Type (Select all that apply)</label>
                            <div class="checkbox-grid">
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="museum"><span>Museum</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="park"><span>Park</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="thrift-shop"><span>Thrift Shop</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="metaphysical-shop"><span>Metaphysical Shop</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="bookstore"><span>Bookstore</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="concert"><span>Concert</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="festival"><span>Festival</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="market"><span>Market</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="nature"><span>Nature Spot</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="entertainment"><span>Entertainment</span></label>
                                <label class="checkbox-label"><input type="checkbox" name="placeType" value="historic"><span>Historic Site</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="details" placeholder="What do we love about this place?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="our-places-image" accept="image/*" onchange="previewImage(event, 'our-places')">
                            <label for="our-places-image" class="image-upload-label">Choose Image</label>
                            <div id="our-places-preview"></div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('our-places')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="our-places-list">
                    <div class="empty-state">No favorites yet!</div>
                </div>
            </div>
        </div>

        <!-- WISHLISTS TAB -->
        <div id="wishlists-tab" class="dreams-tab">
            <div class="section" style="margin-bottom: 24px;">
                <h2 class="section-title">Kasey's Wishlist</h2>
                
                <button class="add-dream-btn" onclick="showForm('kasey-wishlist')">+ Add to Kasey's List</button>
                
                <div class="dream-form" id="kasey-wishlist-form">
                    <form data-category="kasey-wishlist">
                        <div class="form-group">
                            <label>Item or Experience</label>
                            <input type="text" name="title" required placeholder="What does Kasey want?">
                        </div>
                        <div class="form-group">
                            <label>Details / Link</label>
                            <textarea name="details" placeholder="Where to find it, price, why you want it..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="kasey-wishlist-image" accept="image/*" onchange="previewImage(event, 'kasey-wishlist')">
                            <label for="kasey-wishlist-image" class="image-upload-label">Choose Image</label>
                            <div id="kasey-wishlist-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">Nice to Have</option>
                                <option value="soon">Really Want</option>
                                <option value="high">Top of List</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('kasey-wishlist')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="kasey-wishlist-list">
                    <div class="empty-state">Kasey's wishlist is empty</div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">Charlie's Wishlist</h2>
                
                <button class="add-dream-btn" onclick="showForm('charlie-wishlist')">+ Add to Charlie's List</button>
                
                <div class="dream-form" id="charlie-wishlist-form">
                    <form data-category="charlie-wishlist">
                        <div class="form-group">
                            <label>Item or Experience</label>
                            <input type="text" name="title" required placeholder="What does Charlie want?">
                        </div>
                        <div class="form-group">
                            <label>Details / Link</label>
                            <textarea name="details" placeholder="Where to find it, price, why you want it..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="charlie-wishlist-image" accept="image/*" onchange="previewImage(event, 'charlie-wishlist')">
                            <label for="charlie-wishlist-image" class="image-upload-label">Choose Image</label>
                            <div id="charlie-wishlist-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">Nice to Have</option>
                                <option value="soon">Really Want</option>
                                <option value="high">Top of List</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('charlie-wishlist')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="charlie-wishlist-list">
                    <div class="empty-state">Charlie's wishlist is empty</div>
                </div>
            </div>
        </div>

        <!-- TRAVEL TAB -->
        <div id="travel-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Places We Want to Travel</h2>
                
                <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                    <button class="add-dream-btn" onclick="showForm('travel')" style="flex: 1;">+ Add Travel Dream</button>
                    <button class="add-dream-btn" onclick="chooseRandomDream('travel')" style="flex: 1; border: 2px solid #7ba886; color: #7ba886; background: transparent;">Choose for Us</button>
                </div>
                
                <div class="dream-form" id="travel-form">
                    <form data-category="travel">
                        <div class="form-group">
                            <label>Destination</label>
                            <input type="text" name="title" required placeholder="Where do you want to go?">
                        </div>
                        <div class="form-group">
                            <label>Why / What to Do There</label>
                            <textarea name="details" placeholder="What draws you to this place?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="travel-image" accept="image/*" onchange="previewImage(event, 'travel')">
                            <label for="travel-image" class="image-upload-label">Choose Image</label>
                            <div id="travel-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">I'd Like to Go</option>
                                <option value="soon">I'd Love to Go</option>
                                <option value="high">Top of My List!</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('travel')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="travel-list">
                    <div class="empty-state">No travel dreams yet. Where do you want to go?</div>
                </div>

                <hr class="section-divider">

                <h2 class="section-title">Where We've Been ♡</h2>
                <p style="font-size: 0.8rem; color: rgba(74,58,60,0.5); margin-bottom: 12px;">Places we loved and would visit again</p>

                <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                    <button class="add-dream-btn" onclick="showForm('our-travel')" style="flex: 1;">+ Add a Favorite</button>
                    <button class="add-dream-btn" onclick="chooseRandomDream('our-travel')" style="flex: 1; border: 2px solid #7ba886; color: #7ba886; background: transparent;">Choose for Us</button>
                </div>

                <div class="dream-form" id="our-travel-form">
                    <form data-category="our-travel">
                        <div class="form-group">
                            <label>Destination</label>
                            <input type="text" name="title" required placeholder="Where did you go?">
                        </div>
                        <div class="form-group">
                            <label>Details & Memories</label>
                            <textarea name="details" placeholder="What did you love about it?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="our-travel-image" accept="image/*" onchange="previewImage(event, 'our-travel')">
                            <label for="our-travel-image" class="image-upload-label">Choose Image</label>
                            <div id="our-travel-preview"></div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('our-travel')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="our-travel-list">
                    <div class="empty-state">No favorite trips yet!</div>
                </div>
            </div>
        </div>

        <!-- TV SHOWS & MOVIES TAB -->
        <div id="shows-movies-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Shows & Movies to Watch</h2>
                
                <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                    <button class="add-dream-btn" onclick="showForm('shows-movies')" style="flex: 1;">+ Add Show or Movie</button>
                    <button class="add-dream-btn" onclick="chooseRandomDream('shows-movies')" style="flex: 1; border: 2px solid #7ba886; color: #7ba886; background: transparent;">Choose for Us</button>
                </div>
                
                <div class="dream-form" id="shows-movies-form">
                    <form data-category="shows-movies">
                        <div class="form-group">
                            <label>Title</label>
                            <input type="text" name="title" required placeholder="Name of the show or movie">
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="details" placeholder="Where to watch? Genre? Why you want to see it?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="shows-movies-image" accept="image/*" onchange="previewImage(event, 'shows-movies')">
                            <label for="shows-movies-image" class="image-upload-label">Choose Image</label>
                            <div id="shows-movies-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">I'd Like to Watch</option>
                                <option value="soon">I'd Love to Watch</option>
                                <option value="high">We Have to Watch!</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('shows-movies')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="shows-movies-list">
                    <div class="empty-state">No shows or movies yet. What do you want to watch together?</div>
                </div>

                <hr class="section-divider">

                <h2 class="section-title">What We've Watched ♡</h2>
                <p style="font-size: 0.8rem; color: rgba(74,58,60,0.5); margin-bottom: 12px;">Shows & movies we loved</p>

                <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                    <button class="add-dream-btn" onclick="showForm('our-shows-movies')" style="flex: 1;">+ Add a Favorite</button>
                    <button class="add-dream-btn" onclick="chooseRandomDream('our-shows-movies')" style="flex: 1; border: 2px solid #7ba886; color: #7ba886; background: transparent;">Choose for Us</button>
                </div>

                <div class="dream-form" id="our-shows-movies-form">
                    <form data-category="our-shows-movies">
                        <div class="form-group">
                            <label>Title</label>
                            <input type="text" name="title" required placeholder="Name of the show or movie">
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="details" placeholder="Where to watch? What did we love about it?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="our-shows-movies-image" accept="image/*" onchange="previewImage(event, 'our-shows-movies')">
                            <label for="our-shows-movies-image" class="image-upload-label">Choose Image</label>
                            <div id="our-shows-movies-preview"></div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('our-shows-movies')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="our-shows-movies-list">
                    <div class="empty-state">No favorites yet!</div>
                </div>
            </div>
        </div>

        <!-- BUCKET LIST TAB -->
        <div id="bucket-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Our Bucket List</h2>
                
                <button class="add-dream-btn" onclick="showForm('bucket')">+ Add to Bucket List</button>
                
                <div class="dream-form" id="bucket-form">
                    <form data-category="bucket">
                        <div class="form-group">
                            <label>Experience or Goal</label>
                            <input type="text" name="title" required placeholder="What do you want to do together?">
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="details" placeholder="Any specifics or ideas?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="bucket-image" accept="image/*" onchange="previewImage(event, 'bucket')">
                            <label for="bucket-image" class="image-upload-label">Choose Image</label>
                            <div id="bucket-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">I'd Like to Do</option>
                                <option value="soon">I'd Love to Do</option>
                                <option value="high">We Have to Do!</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('bucket')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="bucket-list">
                    <div class="empty-state">Start building your bucket list together!</div>
                </div>
            </div>
        </div>

        <!-- DREAM HOME TAB -->
        <div id="home-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Dream Home Features</h2>
                
                <button class="add-dream-btn" onclick="showForm('home')">+ Add Home Feature</button>
                
                <div class="dream-form" id="home-form">
                    <form data-category="home">
                        <div class="form-group">
                            <label>Feature or Room</label>
                            <input type="text" name="title" required placeholder="What do you want in your dream home?">
                        </div>
                        <div class="form-group">
                            <label>Details / Vision</label>
                            <textarea name="details" placeholder="Describe how you imagine it..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="home-image" accept="image/*" onchange="previewImage(event, 'home')">
                            <label for="home-image" class="image-upload-label">Choose Image</label>
                            <div id="home-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Importance</label>
                            <select name="priority">
                                <option value="">Nice to Have</option>
                                <option value="soon">Really Want</option>
                                <option value="high">Must Have</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('home')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="home-list">
                    <div class="empty-state">What does your dream home look like?</div>
                </div>
            </div>
        </div>

        <!-- PETS TAB -->
        <div id="pets-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Future Pets & Animal Dreams</h2>
                
                <button class="add-dream-btn" onclick="showForm('pets')">+ Add Pet Dream</button>
                
                <div class="dream-form" id="pets-form">
                    <form data-category="pets">
                        <div class="form-group">
                            <label>Pet Type or Name Idea</label>
                            <input type="text" name="title" required placeholder="What kind of pet?">
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="details" placeholder="Breed, personality, care needs, name ideas..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="pets-image" accept="image/*" onchange="previewImage(event, 'pets')">
                            <label for="pets-image" class="image-upload-label">Choose Image</label>
                            <div id="pets-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Timeline</label>
                            <select name="priority">
                                <option value="">Someday</option>
                                <option value="soon">Within a Year</option>
                                <option value="high">Ready Now</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('pets')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="pets-list">
                    <div class="empty-state">Dream about your future fur (or scale, or feather) babies!</div>
                </div>
            </div>
        </div>

        <!-- TRADITIONS TAB -->
        <div id="traditions-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Traditions We Want to Start</h2>
                
                <button class="add-dream-btn" onclick="showForm('traditions')">+ Add Tradition Idea</button>
                
                <div class="dream-form" id="traditions-form">
                    <form data-category="traditions">
                        <div class="form-group">
                            <label>Tradition Name</label>
                            <input type="text" name="title" required placeholder="What tradition do you want to start?">
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="details" placeholder="When? How often? What would it look like?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Add Image (Optional)</label>
                            <input type="file" class="image-upload-input" id="traditions-image" accept="image/*" onchange="previewImage(event, 'traditions')">
                            <label for="traditions-image" class="image-upload-label">Choose Image</label>
                            <div id="traditions-preview"></div>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">Future Idea</option>
                                <option value="soon">Start Soon</option>
                                <option value="high">Start This Year</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('traditions')">Cancel</button>
                            <button type="button" class="btn save-btn" onclick="addDream(this)">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="traditions-list">
                    <div class="empty-state">What traditions do you want to create together?</div>
                </div>
            </div>
        </div>
    </div>

    <div class="random-choice" id="randomChoice">
        <h2>WE CHOOSE...</h2>
        <div class="random-choice-title" id="randomChoiceTitle"></div>
        <div class="random-choice-details" id="randomChoiceDetails"></div>
        <img class="random-choice-image" id="randomChoiceImage" src="" alt="" style="display: none;">
        <div class="random-choice-buttons">
            <button class="btn" onclick="closeRandomChoice()">Let's Do It!</button>
            <button class="btn" onclick="pickAnotherRandom()">Pick Another</button>
        </div>
    </div>

    <div class="celebration" id="celebration">
        <h2>DREAM ACHIEVED!</h2>
        <p id="celebrationText">Amazing! You made it happen!</p>
        <button class="btn" onclick="closeCelebration()">Continue Dreaming</button>
    </div>

    <div class="lightbox" id="lightbox" onclick="closeLightbox()">
        <button class="lightbox-close" onclick="closeLightbox()">&times;</button>
        <img class="lightbox-image" id="lightboxImage" src="" alt="">
    </div>

    <!-- Detail Popup -->
    <div class="detail-popup" id="detailPopup" onclick="if(event.target===this)closeDetail()">
        <div class="detail-popup-box">
            <button class="detail-popup-close" onclick="closeDetail()">&times;</button>
            <div class="detail-popup-title" id="detailTitle"></div>
            <div class="detail-popup-meta" id="detailMeta"></div>
            <div class="detail-popup-details" id="detailDetails"></div>
            <img class="detail-popup-image" id="detailImage" src="" alt="" style="display:none;" onclick="openLightbox(this.src)">
            <div class="detail-popup-actions" id="detailActions"></div>
        </div>
    </div>

    <!-- Tried It / Done Modal -->
    <div class="tried-modal" id="triedModal" onclick="if(event.target===this)closeTriedModal()">
        <div class="tried-modal-box">
            <div class="tried-modal-title" id="triedModalTitle">We tried it!</div>
            <div class="tried-modal-name" id="triedModalName"></div>
            <div class="tried-modal-buttons">
                <button class="tried-btn-again" id="triedBtnAgain" onclick="keepItem()">♡ Again</button>
                <button class="tried-btn-pass" onclick="passItem()">Pass</button>
                <button class="tried-btn-cancel" onclick="closeTriedModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="dream-form" id="edit-form">
        <form data-category="edit">
            <h3 style="color: #4a3a3c; margin-bottom: 16px; font-size: 1rem;">Edit Entry</h3>
            <input type="hidden" id="editFirebaseId">
            <input type="hidden" id="editCategory">
            <div class="form-group">
                <label>Name</label>
                <input type="text" id="editTitle" placeholder="Name">
            </div>
            <div class="form-group">
                <label>Details</label>
                <textarea id="editDetails" placeholder="Details"></textarea>
            </div>
            <div class="form-group" id="editTypeGroup" style="display:none;">
                <label>Type</label>
                <div class="checkbox-grid" id="editTypeCheckboxes">
                    <label class="checkbox-label"><input type="checkbox" name="editType" value="breakfast"><span>Breakfast</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editType" value="brunch"><span>Brunch</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editType" value="lunch"><span>Lunch</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editType" value="dinner"><span>Dinner</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editType" value="cafe"><span>Cafe</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editType" value="bar"><span>Bar</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editType" value="bakery"><span>Bakery</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editType" value="dessert"><span>Dessert</span></label>
                </div>
            </div>
            <div class="form-group" id="editPlaceTypeGroup" style="display:none;">
                <label>Type</label>
                <div class="checkbox-grid" id="editPlaceTypeCheckboxes">
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="museum"><span>Museum</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="park"><span>Park</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="thrift-shop"><span>Thrift Shop</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="metaphysical-shop"><span>Metaphysical Shop</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="bookstore"><span>Bookstore</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="concert"><span>Concert</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="festival"><span>Festival</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="market"><span>Market</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="nature"><span>Nature Spot</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="entertainment"><span>Entertainment</span></label>
                    <label class="checkbox-label"><input type="checkbox" name="editPlaceType" value="historic"><span>Historic Site</span></label>
                </div>
            </div>
            <div class="form-group" id="editOccasionGroup" style="display:none;">
                <label>Occasion</label>
                <select id="editOccasion">
                    <option value="">Casual</option>
                    <option value="date-night">Date Night</option>
                    <option value="friends">Go with Friends</option>
                    <option value="special">Special Occasion</option>
                </select>
            </div>
            <div class="form-group" id="editPriorityGroup">
                <label>Priority</label>
                <select id="editPriority">
                    <option value="">Normal</option>
                    <option value="soon">Soon</option>
                    <option value="high">High Priority</option>
                </select>
            </div>
            <div class="form-actions">
                <button type="button" class="btn" onclick="closeEditForm()">Cancel</button>
                <button type="button" class="btn save-btn" onclick="saveEdit()">Save Changes</button>
            </div>
        </form>
    </div>

    <script>
        // Global variables — available immediately
        var categories = ['restaurants', 'our-restaurants', 'places', 'our-places', 'kasey-wishlist', 'charlie-wishlist', 'travel', 'our-travel', 'bucket', 'home', 'pets', 'traditions', 'shows-movies', 'our-shows-movies'];
        var dreams = {};
        var isConnected = false;
        var currentImageData = {};
        var currentRandomCategory = '';
        var triedItData = { category: '', firebaseId: '' };

        // Initialize dreams object
        categories.forEach(function(cat) { dreams[cat] = []; });

        function escapeHtml(text) {
            var div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function saveToLocal(category) {
            try { localStorage.setItem('dreams_' + category, JSON.stringify(dreams[category])); } catch(e) {}
        }

        // Sync category to Firestore (non-blocking, strips large images)
        function syncToFirestore(category) {
            if (window.dreamsDb && window.fsModule) {
                try {
                    var itemsForSync = dreams[category].map(function(d) {
                        var copy = Object.assign({}, d);
                        if (copy.image && copy.image.length > 50000) {
                            copy.image = null;
                        }
                        return copy;
                    });
                    var docRef = window.fsModule.doc(window.dreamsDb, 'dreams', category);
                    window.fsModule.setDoc(docRef, { items: itemsForSync }).catch(function(err) {});
                } catch(e) {}
            }
        }

        function loadFromLocal(category) {
            try {
                var data = localStorage.getItem('dreams_' + category);
                return data ? JSON.parse(data) : [];
            } catch(e) { return []; }
        }

        // === UI FUNCTIONS (work immediately) ===

        window.previewImage = function(event, category) {
            var file = event.target.files[0];
            if (file) {
                var reader = new FileReader();
                reader.onload = function(e) {
                    currentImageData[category] = e.target.result;
                    var preview = document.getElementById(category + '-preview');
                    preview.innerHTML = '<img src="' + e.target.result + '" class="image-upload-preview" alt="Preview">';
                };
                reader.readAsDataURL(file);
            }
        };

        window.openLightbox = function(imageSrc) {
            document.getElementById('lightboxImage').src = imageSrc;
            document.getElementById('lightbox').classList.add('show');
        };

        window.closeLightbox = function() {
            document.getElementById('lightbox').classList.remove('show');
        };

        window.switchToSection = function(section) {
            document.querySelectorAll('.dreams-tab').forEach(function(t) { t.classList.remove('active'); });
            document.getElementById(section + '-tab').classList.add('active');
        };

        window.showForm = function(category) {
            var formEl = document.getElementById(category + '-form');
            formEl.classList.add('active');
            document.body.style.overflow = 'hidden';
            // Close on backdrop click
            formEl._backdropHandler = function(e) {
                if (e.target === formEl) {
                    window.hideForm(category);
                }
            };
            formEl.addEventListener('click', formEl._backdropHandler);
        };

        window.hideForm = function(category) {
            var form = document.getElementById(category + '-form');
            form.classList.remove('active');
            form.querySelector('form').reset();
            var preview = document.getElementById(category + '-preview');
            if (preview) preview.innerHTML = '';
            delete currentImageData[category];
            document.body.style.overflow = '';
            if (form._backdropHandler) {
                form.removeEventListener('click', form._backdropHandler);
                delete form._backdropHandler;
            }
        };

        window.addDream = function(btn) {
            try {
                // Walk up from button to find the form
                var form = btn.closest('form');
                if (!form) { alert('Could not find form'); return; }
                
                var category = form.getAttribute('data-category');
                if (!category) { alert('Could not find category'); return; }

                // Get form values directly from inputs
                var titleInput = form.querySelector('input[name="title"]');
                var title = titleInput ? titleInput.value.trim() : '';
                
                if (!title) {
                    alert('Please enter a name');
                    return;
                }

                var detailsInput = form.querySelector('[name="details"]');
                var priorityInput = form.querySelector('[name="priority"]');
                var occasionInput = form.querySelector('[name="occasion"]');

                var dream = {
                    id: Date.now(),
                    firebaseId: 'item_' + Date.now(),
                    title: title,
                    details: detailsInput ? detailsInput.value.trim() : '',
                    priority: priorityInput ? priorityInput.value : '',
                    achieved: false,
                    dateAdded: new Date().toISOString(),
                    image: currentImageData[category] || null
                };

                if (category === 'restaurants' || category === 'our-restaurants') {
                    dream.occasion = occasionInput ? occasionInput.value : '';
                    var checked = form.querySelectorAll('input[name="restaurantType"]:checked');
                    var types = [];
                    for (var i = 0; i < checked.length; i++) types.push(checked[i].value);
                    if (types.length > 0) dream.restaurantTypes = types;
                }

                if (category === 'places' || category === 'our-places') {
                    var pchecked = form.querySelectorAll('input[name="placeType"]:checked');
                    var ptypes = [];
                    for (var i = 0; i < pchecked.length; i++) ptypes.push(pchecked[i].value);
                    if (ptypes.length > 0) dream.placeTypes = ptypes;
                }

                // Save to array + localStorage
                if (!dreams[category]) dreams[category] = [];
                dreams[category].push(dream);
                saveToLocal(category);
                renderDreams(category);

                // Sync to Firestore in background
                syncToFirestore(category);

                // Expand list so user sees their item
                var listEl = document.getElementById(category + '-list');
                if (listEl) {
                    listEl.classList.add('expanded');
                    localStorage.setItem('dreamListExpanded_' + category, 'true');
                }

                // Reset and close form
                form.reset();
                var preview = document.getElementById(category + '-preview');
                if (preview) preview.innerHTML = '';
                delete currentImageData[category];
                window.hideForm(category);

            } catch(err) {
                alert('Error: ' + err.message);
                try { saveToLocal(category); renderDreams(category); } catch(x) {}
            }
        };

        window.toggleDreamList = function(category) {
            var list = document.getElementById(category + '-list');
            list.classList.toggle('expanded');
            var isExpanded = list.classList.contains('expanded');
            localStorage.setItem('dreamListExpanded_' + category, isExpanded);
        };

        window.toggleAchieved = function(category, firebaseId, newAchievedState, btn) {
            if (btn) btn.classList.add('saving');

            try {
                var dream = dreams[category].find(function(d) { return d.firebaseId === firebaseId; });
                if (dream) {
                    dream.achieved = newAchievedState;
                    saveToLocal(category);
                    renderDreams(category);
                    
                    // Sync to Firestore in background
                    syncToFirestore(category);
                    
                    if (newAchievedState) showCelebration(dream.title);
                }
            } catch(err) {
                try { saveToLocal(category); renderDreams(category); } catch(e) {}
            }

            if (btn) btn.classList.remove('saving');
        };

        window.deleteDream = function(category, firebaseId, btn) {
            // Tap once = "Sure?", tap again = delete
            if (btn && btn.dataset.confirmDelete === 'yes') {
                try {
                    dreams[category] = dreams[category].filter(function(d) { return d.firebaseId !== firebaseId; });
                    saveToLocal(category);
                    renderDreams(category);
                    syncToFirestore(category);
                } catch(err) {
                    try { saveToLocal(category); renderDreams(category); } catch(e) {}
                }
            } else if (btn) {
                btn.dataset.confirmDelete = 'yes';
                btn.textContent = 'Sure?';
                btn.style.color = '#c0392b';
                btn.style.borderColor = '#c0392b';
                // Reset after 3 seconds if not confirmed
                setTimeout(function() {
                    if (btn && btn.parentNode) {
                        btn.dataset.confirmDelete = '';
                        btn.textContent = 'Delete';
                        btn.style.color = '';
                        btn.style.borderColor = '';
                    }
                }, 3000);
            }
        };

        // === TRIED IT / DONE (generic for restaurants, places, travel, shows-movies) ===
        // Maps source category → destination "our" category
        var triedItMap = {
            'restaurants': { dest: 'our-restaurants', title: 'We tried it!', keep: '♡ Eat Again' },
            'places': { dest: 'our-places', title: 'We went!', keep: '♡ Go Again' },
            'travel': { dest: 'our-travel', title: 'We traveled!', keep: '♡ Visit Again' },
            'shows-movies': { dest: 'our-shows-movies', title: 'We watched it!', keep: '♡ Watch Again' }
        };

        window.triedIt = function(category, firebaseId) {
            var dream = dreams[category].find(function(d) { return d.firebaseId === firebaseId; });
            if (!dream) return;
            var config = triedItMap[category];
            if (!config) return;
            triedItData.category = category;
            triedItData.firebaseId = firebaseId;
            document.getElementById('triedModalTitle').textContent = config.title;
            document.getElementById('triedModalName').textContent = dream.title;
            document.getElementById('triedBtnAgain').textContent = config.keep;
            document.getElementById('triedModal').classList.add('active');
        };

        window.closeTriedModal = function() {
            document.getElementById('triedModal').classList.remove('active');
            triedItData = { category: '', firebaseId: '' };
        };

        window.keepItem = function() {
            try {
                var srcCat = triedItData.category;
                var config = triedItMap[srcCat];
                if (!config) { closeTriedModal(); return; }
                var destCat = config.dest;

                var dream = dreams[srcCat].find(function(d) { return d.firebaseId === triedItData.firebaseId; });
                if (!dream) { closeTriedModal(); return; }

                // Copy to "our" list
                var favorite = Object.assign({}, dream);
                favorite.id = Date.now();
                favorite.firebaseId = 'item_' + favorite.id;
                favorite.achieved = false;
                delete favorite.priority;

                if (!dreams[destCat]) dreams[destCat] = [];
                dreams[destCat].push(favorite);
                saveToLocal(destCat);
                syncToFirestore(destCat);
                renderDreams(destCat);

                // Remove from want-to-try list
                dreams[srcCat] = dreams[srcCat].filter(function(d) { return d.firebaseId !== triedItData.firebaseId; });
                saveToLocal(srcCat);
                syncToFirestore(srcCat);
                renderDreams(srcCat);

                // Auto-expand the "our" list
                var listEl = document.getElementById(destCat + '-list');
                if (listEl) {
                    listEl.classList.add('expanded');
                    localStorage.setItem('dreamListExpanded_' + destCat, 'true');
                }

                closeTriedModal();
            } catch(err) {
                alert('Error: ' + err.message);
                closeTriedModal();
            }
        };

        window.passItem = function() {
            try {
                var srcCat = triedItData.category;
                dreams[srcCat] = dreams[srcCat].filter(function(d) { return d.firebaseId !== triedItData.firebaseId; });
                saveToLocal(srcCat);
                syncToFirestore(srcCat);
                renderDreams(srcCat);
                closeTriedModal();
            } catch(err) {
                alert('Error: ' + err.message);
                closeTriedModal();
            }
        };

        // === EDIT DREAM ===
        window.editDream = function(category, firebaseId) {
            var dream = dreams[category].find(function(d) { return d.firebaseId === firebaseId; });
            if (!dream) return;

            document.getElementById('editFirebaseId').value = firebaseId;
            document.getElementById('editCategory').value = category;
            document.getElementById('editTitle').value = dream.title || '';
            document.getElementById('editDetails').value = dream.details || '';
            document.getElementById('editPriority').value = dream.priority || '';

            var isRestaurant = (category === 'restaurants' || category === 'our-restaurants');
            var isPlace = (category === 'places' || category === 'our-places');
            var isOurList = (category.indexOf('our-') === 0);

            // Show/hide category-specific fields
            document.getElementById('editTypeGroup').style.display = isRestaurant ? '' : 'none';
            document.getElementById('editPlaceTypeGroup').style.display = isPlace ? '' : 'none';
            document.getElementById('editOccasionGroup').style.display = isRestaurant ? '' : 'none';
            document.getElementById('editPriorityGroup').style.display = isOurList ? 'none' : '';

            // Set restaurant type checkboxes
            if (isRestaurant) {
                var types = dream.restaurantTypes || [];
                var checkboxes = document.querySelectorAll('#editTypeCheckboxes input[name="editType"]');
                for (var i = 0; i < checkboxes.length; i++) {
                    checkboxes[i].checked = types.indexOf(checkboxes[i].value) !== -1;
                }
                document.getElementById('editOccasion').value = dream.occasion || '';
            }

            // Set place type checkboxes
            if (isPlace) {
                var ptypes = dream.placeTypes || [];
                var pcheckboxes = document.querySelectorAll('#editPlaceTypeCheckboxes input[name="editPlaceType"]');
                for (var i = 0; i < pcheckboxes.length; i++) {
                    pcheckboxes[i].checked = ptypes.indexOf(pcheckboxes[i].value) !== -1;
                }
            }

            var formEl = document.getElementById('edit-form');
            formEl.classList.add('active');
            document.body.style.overflow = 'hidden';
            formEl._backdropHandler = function(e) {
                if (e.target === formEl) closeEditForm();
            };
            formEl.addEventListener('click', formEl._backdropHandler);
        };

        window.closeEditForm = function() {
            var formEl = document.getElementById('edit-form');
            formEl.classList.remove('active');
            document.body.style.overflow = '';
            if (formEl._backdropHandler) {
                formEl.removeEventListener('click', formEl._backdropHandler);
                delete formEl._backdropHandler;
            }
        };

        window.saveEdit = function() {
            try {
                var firebaseId = document.getElementById('editFirebaseId').value;
                var category = document.getElementById('editCategory').value;

                var dream = dreams[category].find(function(d) { return d.firebaseId === firebaseId; });
                if (!dream) { closeEditForm(); return; }

                dream.title = document.getElementById('editTitle').value.trim();
                dream.details = document.getElementById('editDetails').value.trim();
                dream.priority = document.getElementById('editPriority').value;

                var isRestaurant = (category === 'restaurants' || category === 'our-restaurants');
                var isPlace = (category === 'places' || category === 'our-places');

                if (isRestaurant) {
                    var checked = document.querySelectorAll('#editTypeCheckboxes input[name="editType"]:checked');
                    var types = [];
                    for (var i = 0; i < checked.length; i++) types.push(checked[i].value);
                    dream.restaurantTypes = types;
                    dream.occasion = document.getElementById('editOccasion').value;
                }

                if (isPlace) {
                    var pchecked = document.querySelectorAll('#editPlaceTypeCheckboxes input[name="editPlaceType"]:checked');
                    var ptypes = [];
                    for (var i = 0; i < pchecked.length; i++) ptypes.push(pchecked[i].value);
                    dream.placeTypes = ptypes;
                }

                saveToLocal(category);
                syncToFirestore(category);
                renderDreams(category);
                closeEditForm();
            } catch(err) {
                alert('Error: ' + err.message);
            }
        };

        window.closeCelebration = function() {
            document.getElementById('celebration').classList.remove('show');
        };

        window.chooseRandomDream = function(category) {
            currentRandomCategory = category;
            var unachievedDreams = dreams[category].filter(function(d) { return !d.achieved; });
            if (unachievedDreams.length === 0) {
                alert('No items to choose from yet! Add some first.');
                return;
            }
            var randomDream = unachievedDreams[Math.floor(Math.random() * unachievedDreams.length)];
            showRandomChoice(randomDream);
        };

        function showRandomChoice(dream) {
            document.getElementById('randomChoiceTitle').textContent = dream.title;
            document.getElementById('randomChoiceDetails').textContent = dream.details || '';
            var img = document.getElementById('randomChoiceImage');
            if (dream.image) {
                img.src = dream.image;
                img.style.display = 'block';
            } else {
                img.style.display = 'none';
            }
            document.getElementById('randomChoice').classList.add('show');
        }

        window.closeRandomChoice = function() {
            document.getElementById('randomChoice').classList.remove('show');
            currentRandomCategory = '';
        };

        window.pickAnotherRandom = function() {
            document.getElementById('randomChoice').classList.remove('show');
            setTimeout(function() {
                window.chooseRandomDream(currentRandomCategory);
            }, 200);
        };

        function showCelebration(dreamTitle) {
            document.getElementById('celebrationText').textContent = 'You achieved: "' + dreamTitle + '"';
            document.getElementById('celebration').classList.add('show');
            createConfetti();
        }

        function createConfetti() {
            var colors = ['#b59197', '#7ba886', '#d4a5ae', '#ff9999', '#ffcc99', '#a8e6cf', '#95c9b4'];
            for (var i = 0; i < 100; i++) {
                (function(idx) {
                    setTimeout(function() {
                        var confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * 100 + '%';
                        confetti.style.top = '-10px';
                        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                        var size = Math.random() * 8 + 6;
                        confetti.style.width = size + 'px';
                        confetti.style.height = size + 'px';
                        var duration = Math.random() * 2 + 2;
                        confetti.style.animationDuration = duration + 's';
                        document.body.appendChild(confetti);
                        setTimeout(function() { confetti.remove(); }, duration * 1000);
                    }, idx * 30);
                })(i);
            }
        }

        // === DETAIL POPUP ===
        window.openDetail = function(category, firebaseId) {
            var dream = dreams[category].find(function(d) { return d.firebaseId === firebaseId; });
            if (!dream) return;

            document.getElementById('detailTitle').textContent = dream.title;

            // Build tags
            var tags = '';
            if (dream.priority === 'high') tags += '<span class="dream-tag priority-high">High Priority</span>';
            else if (dream.priority === 'soon') tags += '<span class="dream-tag priority-soon">Soon</span>';

            if (dream.occasion === 'date-night') tags += '<span class="dream-tag occasion-date-night">Date Night</span>';
            else if (dream.occasion === 'friends') tags += '<span class="dream-tag occasion-friends">Go with Friends</span>';
            else if (dream.occasion === 'special') tags += '<span class="dream-tag occasion-special">Special Occasion</span>';

            if (dream.restaurantTypes && Array.isArray(dream.restaurantTypes)) {
                dream.restaurantTypes.forEach(function(t) {
                    tags += '<span class="dream-tag">' + t.charAt(0).toUpperCase() + t.slice(1) + '</span>';
                });
            }
            if (dream.placeTypes && Array.isArray(dream.placeTypes)) {
                dream.placeTypes.forEach(function(t) {
                    tags += '<span class="dream-tag">' + t.split('-').map(function(w) { return w.charAt(0).toUpperCase() + w.slice(1); }).join(' ') + '</span>';
                });
            }
            document.getElementById('detailMeta').innerHTML = tags;
            document.getElementById('detailMeta').style.display = tags ? '' : 'none';

            // Details text
            var detailEl = document.getElementById('detailDetails');
            detailEl.textContent = dream.details || '';
            detailEl.style.display = dream.details ? '' : 'none';

            // Image
            var imgEl = document.getElementById('detailImage');
            if (dream.image) {
                imgEl.src = dream.image;
                imgEl.style.display = '';
            } else {
                imgEl.style.display = 'none';
            }

            // Action buttons
            var triedItCategories = ['restaurants', 'places', 'travel', 'shows-movies'];
            var ourCategories = ['our-restaurants', 'our-places', 'our-travel', 'our-shows-movies'];
            var triedLabels = {
                'restaurants': 'We Tried It!',
                'places': 'We Went!',
                'travel': 'We Traveled!',
                'shows-movies': 'We Watched It!'
            };

            var btns = '';
            if (triedItCategories.indexOf(category) !== -1) {
                btns =
                    '<button class="icon-btn" onclick="closeDetail();triedIt(\'' + category + '\', \'' + firebaseId + '\')">' + triedLabels[category] + '</button>' +
                    '<button class="icon-btn" onclick="closeDetail();editDream(\'' + category + '\', \'' + firebaseId + '\')">Edit</button>' +
                    '<button class="icon-btn" onclick="deleteDreamAndClose(\'' + category + '\', \'' + firebaseId + '\')">Delete</button>';
            } else if (ourCategories.indexOf(category) !== -1) {
                btns =
                    '<button class="icon-btn" onclick="closeDetail();editDream(\'' + category + '\', \'' + firebaseId + '\')">Edit</button>' +
                    '<button class="icon-btn" onclick="deleteDreamAndClose(\'' + category + '\', \'' + firebaseId + '\')">Delete</button>';
            } else {
                btns =
                    '<button class="icon-btn ' + (dream.achieved ? 'achieved' : '') + '" onclick="toggleAchievedAndClose(\'' + category + '\', \'' + firebaseId + '\', ' + !dream.achieved + ')">' +
                    (dream.achieved ? '&#10004; Done' : 'Mark Done') + '</button>' +
                    '<button class="icon-btn" onclick="closeDetail();editDream(\'' + category + '\', \'' + firebaseId + '\')">Edit</button>' +
                    '<button class="icon-btn" onclick="deleteDreamAndClose(\'' + category + '\', \'' + firebaseId + '\')">Delete</button>';
            }
            document.getElementById('detailActions').innerHTML = btns;

            document.getElementById('detailPopup').classList.add('active');
            document.body.style.overflow = 'hidden';
        };

        window.closeDetail = function() {
            document.getElementById('detailPopup').classList.remove('active');
            document.body.style.overflow = '';
        };

        window.deleteDreamAndClose = function(category, firebaseId) {
            // Tap-twice inside the popup
            var btn = event.target;
            if (btn && btn.dataset.confirmDelete === 'yes') {
                try {
                    dreams[category] = dreams[category].filter(function(d) { return d.firebaseId !== firebaseId; });
                    saveToLocal(category);
                    renderDreams(category);
                    syncToFirestore(category);
                } catch(err) {}
                closeDetail();
            } else if (btn) {
                btn.dataset.confirmDelete = 'yes';
                btn.textContent = 'Sure?';
                btn.style.color = '#c0392b';
                btn.style.borderColor = '#c0392b';
                setTimeout(function() {
                    if (btn && btn.parentNode) {
                        btn.dataset.confirmDelete = '';
                        btn.textContent = 'Delete';
                        btn.style.color = '';
                        btn.style.borderColor = '';
                    }
                }, 3000);
            }
        };

        window.toggleAchievedAndClose = function(category, firebaseId, newState) {
            try {
                var dream = dreams[category].find(function(d) { return d.firebaseId === firebaseId; });
                if (dream) {
                    dream.achieved = newState;
                    saveToLocal(category);
                    renderDreams(category);
                    syncToFirestore(category);
                    if (newState) showCelebration(dream.title);
                }
            } catch(err) {}
            closeDetail();
        };

        function renderDreams(category) {
            var listContainer = document.getElementById(category + '-list');
            if (!listContainer) return;

            if (!dreams[category] || dreams[category].length === 0) {
                var emptyMessages = {
                    restaurants: 'No restaurants yet. Where should you go for date night?',
                    'our-restaurants': 'No favorites yet! Add places you already love.',
                    places: 'No places yet. Where do you want to go?',
                    'our-places': 'No favorite spots yet!',
                    'kasey-wishlist': "Kasey's wishlist is empty",
                    'charlie-wishlist': "Charlie's wishlist is empty",
                    travel: 'No travel dreams yet. Where do you want to go?',
                    'our-travel': 'No favorite trips yet!',
                    'shows-movies': 'No shows or movies yet. What do you want to watch together?',
                    'our-shows-movies': 'No favorites yet!',
                    bucket: 'Start building your bucket list together!',
                    home: 'What does your dream home look like?',
                    pets: 'Dream about your future fur (or scale, or feather) babies!',
                    traditions: 'What traditions do you want to create together?'
                };
                listContainer.innerHTML = '<div class="empty-state">' + (emptyMessages[category] || '') + '</div>';
                listContainer.classList.remove('expanded');
                return;
            }

            var sorted = dreams[category].slice().sort(function(a, b) {
                if (a.achieved !== b.achieved) return a.achieved ? 1 : -1;
                var priorityOrder = { high: 0, soon: 1, friends: 2, '': 3 };
                return (priorityOrder[a.priority] || 3) - (priorityOrder[b.priority] || 3);
            });

            var html = '<div class="dream-list-toggle" onclick="toggleDreamList(\'' + category + '\')">' +
                '<span class="dream-list-toggle-text">View List (' + sorted.length + ' item' + (sorted.length !== 1 ? 's' : '') + ')</span>' +
                '<span class="dream-list-arrow">&#9660;</span></div><div class="dream-list-content">';

            sorted.forEach(function(dream) {
                // Compact row: title + indicators + chevron
                var indicators = '';
                if (dream.priority === 'high') indicators += '<span class="indicator-dot high" title="High Priority"></span>';
                else if (dream.priority === 'soon') indicators += '<span class="indicator-dot soon" title="Soon"></span>';
                if (dream.image) indicators += '<span class="indicator-dot has-image" title="Has photo"></span>';

                html += '<div class="dream-item ' + (dream.achieved ? 'achieved' : '') + '" onclick="openDetail(\'' + category + '\', \'' + dream.firebaseId + '\')">' +
                    '<div class="dream-item-content"><div class="dream-item-title">' + escapeHtml(dream.title) + '</div></div>' +
                    '<div class="dream-item-indicators">' + indicators + '</div>' +
                    '<span class="dream-item-chevron">&#9654;</span>' +
                    '</div>';
            });

            html += '</div>';
            listContainer.innerHTML = html;

            var expandedState = localStorage.getItem('dreamListExpanded_' + category);
            if (expandedState === 'true') {
                listContainer.classList.add('expanded');
            } else {
                listContainer.classList.remove('expanded');
            }
        }

        // === LOAD LOCAL DATA IMMEDIATELY ===
        categories.forEach(function(cat) {
            dreams[cat] = loadFromLocal(cat);
            renderDreams(cat);
        });

        // === LOAD FIREBASE (FIRESTORE) IN BACKGROUND ===
        (async function() {
            try {
                var appModule = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js');
                var fsModule = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js');

                var firebaseConfig = {
                    apiKey: "AIzaSyCDda9sPwSY-RQ5rrM5THOvcLtHvcPRYd4",
                    authDomain: "our-habit-hub.firebaseapp.com",
                    projectId: "our-habit-hub",
                    storageBucket: "our-habit-hub.firebasestorage.app",
                    messagingSenderId: "78555830496",
                    appId: "1:78555830496:web:3e457e54729cc11b825885"
                };

                var app;
                try {
                    app = appModule.initializeApp(firebaseConfig);
                } catch(initErr) {
                    // App might already be initialized
                    app = appModule.getApp ? appModule.getApp() : null;
                }
                if (!app) return;
                
                var db = fsModule.getFirestore(app);
                window.dreamsDb = db;
                window.fsModule = fsModule;
                isConnected = true;

                // Save helper
                window.saveDreamsToFirebase = function(category) {
                    syncToFirestore(category);
                };

                // Set up real-time listeners for each category
                categories.forEach(function(category) {
                    var docRef = fsModule.doc(db, 'dreams', category);
                    fsModule.onSnapshot(docRef, function(snapshot) {
                        if (snapshot.exists()) {
                            var data = snapshot.data();
                            if (data && data.items) {
                                // Merge any local-only items that haven't been synced yet
                                var localItems = loadFromLocal(category);
                                var localOnly = localItems.filter(function(item) {
                                    return item.firebaseId && item.firebaseId.indexOf('local_') === 0;
                                });

                                dreams[category] = data.items;

                                // Push local-only items to Firebase
                                if (localOnly.length > 0) {
                                    localOnly.forEach(function(item) {
                                        item.firebaseId = 'item_' + item.id;
                                        dreams[category].push(item);
                                    });
                                    syncToFirestore(category);
                                }

                                saveToLocal(category);
                                renderDreams(category);
                            }
                        } else {
                            // No data in Firestore yet — push local data up
                            if (dreams[category] && dreams[category].length > 0) {
                                syncToFirestore(category);
                            }
                        }
                    }, function(error) {
                        // Firestore error — keep using local data
                    });
                });

            } catch(e) {
                // Firebase failed to load — local storage still works
            }
        })();
    </script>
<script>
function toggleNav() {
    var h = document.getElementById('navHamburger');
    var o = document.getElementById('navOverlay');
    if (!h || !o) return;
    var isOpen = o.classList.contains('open');
    if (isOpen) {
        h.classList.remove('open');
        o.classList.remove('open');
        document.body.style.overflow = '';
    } else {
        h.classList.add('open');
        o.classList.add('open');
        document.body.style.overflow = 'hidden';
    }
}
</script>
</body>
</html>
