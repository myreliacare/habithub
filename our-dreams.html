<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Our Life Together</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant:wght@300;400;500;600;700&family=Work+Sans:wght@600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
            touch-action: pan-y;
        }

        body {
            font-family: 'Cormorant', Georgia, 'Times New Roman', serif;
            background: #1a1a1a;
            min-height: 100vh;
            padding: 16px;
            color: #e0e0e0;
            position: relative;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .btn {
            background: transparent;
            border: 1px solid #444;
            color: #999;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            font-family: inherit;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background: #9b8a9e;
            color: #ffffff;
            border-color: #9b8a9e;
        }

        .page-header {
            text-align: center;
            margin-bottom: 32px;
            margin-top: 24px;
        }

        .page-title {
            background: linear-gradient(135deg, #b59197 0%, #7ba886 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2.5rem;
            font-weight: 400;
            letter-spacing: 0.05em;
            margin-bottom: 8px;
        }

        .page-subtitle {
            color: #999;
            font-size: 0.875rem;
            letter-spacing: 0.05em;
            font-style: italic;
        }

        .section-nav-dropdown {
            margin-bottom: 32px;
        }

        #sectionSelect {
            width: 100%;
            background: #2a2a2a;
            border: 1px solid #9b8a9e;
            color: #9b8a9e;
            padding: 16px;
            font-size: 1rem;
            cursor: pointer;
            font-family: inherit;
            font-weight: 500;
            letter-spacing: 0.05em;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%239b8a9e' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 20px;
            padding-right: 40px;
        }

        #sectionSelect:hover {
            background-color: #333;
            border-color: #b59197;
        }

        #sectionSelect:focus {
            outline: none;
            border-color: #7ba886;
        }

        #sectionSelect option {
            background: #2a2a2a;
            color: #e0e0e0;
            padding: 12px;
        }

        .dreams-tab {
            display: none;
        }

        .dreams-tab.active {
            display: block;
        }

        .section {
            background: #2a2a2a;
            border: 1px solid #9b8a9e;
            padding: 24px;
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 0.75rem;
            font-weight: 400;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: #9b8a9e;
            margin-bottom: 20px;
        }

        .dream-list {
            margin-bottom: 16px;
        }

        .dream-list-toggle {
            background: #1a1a1a;
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #444;
            margin-bottom: 0;
            transition: background 0.2s;
        }

        .dream-list-toggle:hover {
            background: #252525;
        }

        .dream-list-toggle-text {
            color: #9b8a9e;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 500;
        }

        .dream-list-arrow {
            color: #999;
            transition: transform 0.2s;
            font-size: 0.9rem;
        }

        .dream-list.expanded .dream-list-arrow {
            transform: rotate(180deg);
        }

        .dream-list-content {
            display: none;
            padding-top: 12px;
        }

        .dream-list.expanded .dream-list-content {
            display: block;
        }

        .dream-item {
            background: #1a1a1a;
            padding: 16px;
            margin-bottom: 12px;
            border-left: 3px solid #9b8a9e;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 12px;
        }

        .dream-item.achieved {
            opacity: 0.6;
            border-left-color: #7ba886;
        }

        .dream-item-content {
            flex: 1;
        }

        .dream-item-title {
            color: #fff;
            font-size: 1rem;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .dream-item.achieved .dream-item-title {
            text-decoration: line-through;
        }

        .dream-item-details {
            color: #999;
            font-size: 0.85rem;
            line-height: 1.5;
        }

        .dream-item-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .dream-tag {
            background: #3a3a3a;
            color: #b59197;
            padding: 4px 10px;
            font-size: 0.7rem;
            border: 1px solid #444;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .dream-tag.priority-high {
            background: #4a2a2a;
            color: #ff9999;
            border-color: #ff9999;
        }

        .dream-tag.priority-soon {
            background: #3a3a2a;
            color: #ffcc99;
            border-color: #ffcc99;
        }

        .dream-item-actions {
            display: flex;
            gap: 6px;
            flex-direction: column;
        }

        .icon-btn {
            background: transparent;
            border: 1px solid #444;
            color: #999;
            padding: 6px 10px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.2s ease;
            font-family: inherit;
            min-width: 60px;
        }

        .icon-btn:hover {
            background: #9b8a9e;
            color: #ffffff;
            border-color: #9b8a9e;
        }

        .icon-btn.achieved {
            border-color: #7ba886;
            color: #7ba886;
        }

        .icon-btn.achieved:hover {
            background: #7ba886;
            color: #ffffff;
        }

        .add-dream-btn {
            width: 100%;
            background: transparent;
            border: 1px solid #444;
            color: #999;
            padding: 12px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            font-family: inherit;
            margin-top: 8px;
        }

        .add-dream-btn:hover {
            background: #9b8a9e;
            color: #ffffff;
            border-color: #9b8a9e;
        }

        .dream-form {
            display: none;
            background: #1a1a1a;
            padding: 20px;
            margin-top: 15px;
            margin-bottom: 20px;
            border: 1px solid #333;
        }

        .dream-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            color: #999;
            font-size: 0.85rem;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            background: #2a2a2a;
            border: 1px solid #444;
            color: #fff;
            padding: 10px;
            font-size: 0.9rem;
            font-family: inherit;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .form-actions button[type="submit"] {
            border-color: #9b8a9e;
            color: #9b8a9e;
            background: transparent;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .form-actions button[type="submit"]:hover {
            background: #9b8a9e;
            color: #ffffff;
        }

        .empty-state {
            text-align: center;
            color: #666;
            padding: 40px 20px;
            font-style: italic;
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #2a2a2a;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
            text-align: center;
            display: none;
            z-index: 1000;
            border: 2px solid #9b8a9e;
            max-width: 90%;
        }

        .celebration.show {
            display: block;
        }

        .celebration h2 {
            background: linear-gradient(135deg, #b59197 0%, #7ba886 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 12px;
            font-size: 2rem;
            font-weight: 700;
            letter-spacing: 0.1em;
        }

        .celebration p {
            color: #999;
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            animation: confetti-fall 3s linear forwards;
            z-index: 9999;
        }

        @keyframes confetti-fall {
            to {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .dream-item {
                flex-direction: column;
            }

            .dream-item-actions {
                flex-direction: row;
                width: 100%;
            }

            .icon-btn {
                flex: 1;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 12px;
            }

            .page-title {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="btn" style="margin-bottom: 24px;">← Back to Home</a>
        
        <div class="page-header">
            <h1 class="page-title">Our Life Together</h1>
            <p class="page-subtitle">Dreams, goals, ideas & all the things we want to do</p>
        </div>

        <div class="section-nav-dropdown">
            <select id="sectionSelect" onchange="switchToSection(this.value)">
                <option value="wishlists">Wishlists</option>
                <option value="travel">Travel</option>
                <option value="restaurants">Restaurants</option>
                <option value="bucket">Bucket List</option>
                <option value="home">Dream Home</option>
                <option value="pets">Future Pets</option>
                <option value="traditions">Traditions</option>
            </select>
        </div>

        <!-- WISHLISTS TAB -->
        <div id="wishlists-tab" class="dreams-tab active">
            <div class="section" style="margin-bottom: 24px;">
                <h2 class="section-title">Kasey's Wishlist</h2>
                
                <button class="add-dream-btn" onclick="showForm('kasey-wishlist')">+ Add to Kasey's List</button>
                
                <div class="dream-form" id="kasey-wishlist-form">
                    <form onsubmit="addDream(event, 'kasey-wishlist')">
                        <div class="form-group">
                            <label>Item or Experience</label>
                            <input type="text" name="title" required placeholder="What does Kasey want?">
                        </div>
                        <div class="form-group">
                            <label>Details / Link</label>
                            <textarea name="details" placeholder="Where to find it, price, why you want it..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">Nice to Have</option>
                                <option value="soon">Really Want</option>
                                <option value="high">Top of List</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('kasey-wishlist')">Cancel</button>
                            <button type="submit" class="btn">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="kasey-wishlist-list">
                    <div class="empty-state">Kasey's wishlist is empty</div>
                </div>
            </div>

            <div class="section">
                <h2 class="section-title">Charlie's Wishlist</h2>
                
                <button class="add-dream-btn" onclick="showForm('charlie-wishlist')">+ Add to Charlie's List</button>
                
                <div class="dream-form" id="charlie-wishlist-form">
                    <form onsubmit="addDream(event, 'charlie-wishlist')">
                        <div class="form-group">
                            <label>Item or Experience</label>
                            <input type="text" name="title" required placeholder="What does Charlie want?">
                        </div>
                        <div class="form-group">
                            <label>Details / Link</label>
                            <textarea name="details" placeholder="Where to find it, price, why you want it..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">Nice to Have</option>
                                <option value="soon">Really Want</option>
                                <option value="high">Top of List</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('charlie-wishlist')">Cancel</button>
                            <button type="submit" class="btn">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="charlie-wishlist-list">
                    <div class="empty-state">Charlie's wishlist is empty</div>
                </div>
            </div>
        </div>

        <!-- TRAVEL TAB -->
        <div id="travel-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Places We Want to Travel</h2>
                
                <button class="add-dream-btn" onclick="showForm('travel')">+ Add Travel Dream</button>
                
                <div class="dream-form" id="travel-form">
                    <form onsubmit="addDream(event, 'travel')">
                        <div class="form-group">
                            <label>Destination</label>
                            <input type="text" name="title" required placeholder="Where do you want to go?">
                        </div>
                        <div class="form-group">
                            <label>Why / What to Do There</label>
                            <textarea name="details" placeholder="What draws you to this place?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">Someday</option>
                                <option value="soon">Soon</option>
                                <option value="high">Bucket List!</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('travel')">Cancel</button>
                            <button type="submit" class="btn">Save Dream</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="travel-list">
                    <div class="empty-state">No travel dreams yet. Where do you want to go?</div>
                </div>
            </div>
        </div>

        <!-- RESTAURANTS TAB -->
        <div id="restaurants-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Restaurants We Want to Try</h2>
                
                <button class="add-dream-btn" onclick="showForm('restaurants')">+ Add Restaurant</button>
                
                <div class="dream-form" id="restaurants-form">
                    <form onsubmit="addDream(event, 'restaurants')">
                        <div class="form-group">
                            <label>Restaurant Name</label>
                            <input type="text" name="title" required placeholder="Name of the place">
                        </div>
                        <div class="form-group">
                            <label>Location & Details</label>
                            <textarea name="details" placeholder="Where is it? What kind of food? What do you want to try?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Occasion</label>
                            <select name="priority">
                                <option value="">Casual</option>
                                <option value="soon">Date Night</option>
                                <option value="high">Special Occasion</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('restaurants')">Cancel</button>
                            <button type="submit" class="btn">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="restaurants-list">
                    <div class="empty-state">No restaurants yet. Where should you go for date night?</div>
                </div>
            </div>
        </div>

        <!-- BUCKET LIST TAB -->
        <div id="bucket-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Our Bucket List</h2>
                
                <button class="add-dream-btn" onclick="showForm('bucket')">+ Add to Bucket List</button>
                
                <div class="dream-form" id="bucket-form">
                    <form onsubmit="addDream(event, 'bucket')">
                        <div class="form-group">
                            <label>Experience or Goal</label>
                            <input type="text" name="title" required placeholder="What do you want to do together?">
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="details" placeholder="Any specifics or ideas?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">Someday</option>
                                <option value="soon">This Year</option>
                                <option value="high">Top Priority</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('bucket')">Cancel</button>
                            <button type="submit" class="btn">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="bucket-list">
                    <div class="empty-state">Start building your bucket list together!</div>
                </div>
            </div>
        </div>

        <!-- DREAM HOME TAB -->
        <div id="home-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Dream Home Features</h2>
                
                <button class="add-dream-btn" onclick="showForm('home')">+ Add Home Feature</button>
                
                <div class="dream-form" id="home-form">
                    <form onsubmit="addDream(event, 'home')">
                        <div class="form-group">
                            <label>Feature or Room</label>
                            <input type="text" name="title" required placeholder="What do you want in your dream home?">
                        </div>
                        <div class="form-group">
                            <label>Details / Vision</label>
                            <textarea name="details" placeholder="Describe how you imagine it..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Importance</label>
                            <select name="priority">
                                <option value="">Nice to Have</option>
                                <option value="soon">Really Want</option>
                                <option value="high">Must Have</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('home')">Cancel</button>
                            <button type="submit" class="btn">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="home-list">
                    <div class="empty-state">What does your dream home look like?</div>
                </div>
            </div>
        </div>

        <!-- PETS TAB -->
        <div id="pets-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Future Pets & Animal Dreams</h2>
                
                <button class="add-dream-btn" onclick="showForm('pets')">+ Add Pet Dream</button>
                
                <div class="dream-form" id="pets-form">
                    <form onsubmit="addDream(event, 'pets')">
                        <div class="form-group">
                            <label>Pet Type or Name Idea</label>
                            <input type="text" name="title" required placeholder="What kind of pet?">
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="details" placeholder="Breed, personality, care needs, name ideas..."></textarea>
                        </div>
                        <div class="form-group">
                            <label>Timeline</label>
                            <select name="priority">
                                <option value="">Someday</option>
                                <option value="soon">Within a Year</option>
                                <option value="high">Ready Now</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('pets')">Cancel</button>
                            <button type="submit" class="btn">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="pets-list">
                    <div class="empty-state">Dream about your future fur (or scale, or feather) babies!</div>
                </div>
            </div>
        </div>

        <!-- TRADITIONS TAB -->
        <div id="traditions-tab" class="dreams-tab">
            <div class="section">
                <h2 class="section-title">Traditions We Want to Start</h2>
                
                <button class="add-dream-btn" onclick="showForm('traditions')">+ Add Tradition Idea</button>
                
                <div class="dream-form" id="traditions-form">
                    <form onsubmit="addDream(event, 'traditions')">
                        <div class="form-group">
                            <label>Tradition Name</label>
                            <input type="text" name="title" required placeholder="What tradition do you want to start?">
                        </div>
                        <div class="form-group">
                            <label>Details</label>
                            <textarea name="details" placeholder="When? How often? What would it look like?"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Priority</label>
                            <select name="priority">
                                <option value="">Future Idea</option>
                                <option value="soon">Start Soon</option>
                                <option value="high">Start This Year</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn" onclick="hideForm('traditions')">Cancel</button>
                            <button type="submit" class="btn">Save</button>
                        </div>
                    </form>
                </div>

                <div class="dream-list" id="traditions-list">
                    <div class="empty-state">What traditions do you want to create together?</div>
                </div>
            </div>
        </div>
    </div>

    <div class="celebration" id="celebration">
        <h2>DREAM ACHIEVED!</h2>
        <p id="celebrationText">Amazing! You made it happen!</p>
        <button class="btn" onclick="closeCelebration()">Continue Dreaming</button>
    </div>

    <script>
        const categories = ['kasey-wishlist', 'charlie-wishlist', 'travel', 'restaurants', 'bucket', 'home', 'pets', 'traditions'];
        let dreams = {};

        function initDreams() {
            categories.forEach(cat => {
                const saved = localStorage.getItem(`dreams_${cat}`);
                dreams[cat] = saved ? JSON.parse(saved) : [];
                renderDreams(cat);
            });
        }

        function switchToSection(section) {
            document.querySelectorAll('.dreams-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(`${section}-tab`).classList.add('active');
        }

        function showForm(category) {
            document.getElementById(`${category}-form`).classList.add('active');
        }

        function hideForm(category) {
            const form = document.getElementById(`${category}-form`);
            form.classList.remove('active');
            form.querySelector('form').reset();
        }

        function addDream(e, category) {
            e.preventDefault();
            const formData = new FormData(e.target);
            
            const dream = {
                id: Date.now(),
                title: formData.get('title'),
                details: formData.get('details') || '',
                priority: formData.get('priority') || '',
                achieved: false,
                dateAdded: new Date().toISOString()
            };

            dreams[category].push(dream);
            saveDreams(category);
            renderDreams(category);
            hideForm(category);
        }

        function saveDreams(category) {
            localStorage.setItem(`dreams_${category}`, JSON.stringify(dreams[category]));
        }

        function renderDreams(category) {
            const listContainer = document.getElementById(`${category}-list`);
            
            if (dreams[category].length === 0) {
                const emptyMessages = {
                    'kasey-wishlist': 'Kasey\'s wishlist is empty',
                    'charlie-wishlist': 'Charlie\'s wishlist is empty',
                    travel: 'No travel dreams yet. Where do you want to go?',
                    restaurants: 'No restaurants yet. Where should you go for date night?',
                    bucket: 'Start building your bucket list together!',
                    home: 'What does your dream home look like?',
                    pets: 'Dream about your future fur (or scale, or feather) babies!',
                    traditions: 'What traditions do you want to create together?'
                };
                listContainer.innerHTML = `<div class="empty-state">${emptyMessages[category]}</div>`;
                listContainer.classList.remove('expanded');
                return;
            }

            // Sort: unachieved first, then by priority
            const sorted = [...dreams[category]].sort((a, b) => {
                if (a.achieved !== b.achieved) return a.achieved ? 1 : -1;
                const priorityOrder = { high: 0, soon: 1, '': 2 };
                return (priorityOrder[a.priority] || 2) - (priorityOrder[b.priority] || 2);
            });

            // Build the HTML string
            let html = `
                <div class="dream-list-toggle" onclick="toggleDreamList('${category}')">
                    <span class="dream-list-toggle-text">View List (${sorted.length} item${sorted.length !== 1 ? 's' : ''})</span>
                    <span class="dream-list-arrow">▼</span>
                </div>
                <div class="dream-list-content">
            `;

            sorted.forEach(dream => {
                let priorityTag = '';
                if (dream.priority === 'high') {
                    priorityTag = '<span class="dream-tag priority-high">High Priority</span>';
                } else if (dream.priority === 'soon') {
                    priorityTag = '<span class="dream-tag priority-soon">Soon</span>';
                }

                html += `
                    <div class="dream-item ${dream.achieved ? 'achieved' : ''}">
                        <div class="dream-item-content">
                            <div class="dream-item-title">${dream.title}</div>
                            ${dream.details ? `<div class="dream-item-details">${dream.details}</div>` : ''}
                            ${priorityTag ? `<div class="dream-item-meta">${priorityTag}</div>` : ''}
                        </div>
                        <div class="dream-item-actions">
                            <button class="icon-btn ${dream.achieved ? 'achieved' : ''}" onclick="toggleAchieved('${category}', ${dream.id})">
                                ${dream.achieved ? '✓ Done' : 'Mark Done'}
                            </button>
                            <button class="icon-btn" onclick="deleteDream('${category}', ${dream.id})">Delete</button>
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            listContainer.innerHTML = html;
            
            // Check if this list should be expanded by default
            const expandedState = localStorage.getItem(`dreamListExpanded_${category}`);
            if (expandedState === 'true') {
                listContainer.classList.add('expanded');
            } else {
                listContainer.classList.remove('expanded');
            }
        }

        function toggleDreamList(category) {
            const list = document.getElementById(`${category}-list`);
            list.classList.toggle('expanded');
            
            // Save expanded state
            const isExpanded = list.classList.contains('expanded');
            localStorage.setItem(`dreamListExpanded_${category}`, isExpanded);
        }

        function toggleAchieved(category, id) {
            const dream = dreams[category].find(d => d.id === id);
            if (dream) {
                dream.achieved = !dream.achieved;
                if (dream.achieved) {
                    showCelebration(dream.title);
                }
                saveDreams(category);
                renderDreams(category);
            }
        }

        function deleteDream(category, id) {
            if (confirm('Delete this dream?')) {
                dreams[category] = dreams[category].filter(d => d.id !== id);
                saveDreams(category);
                renderDreams(category);
            }
        }

        function showCelebration(dreamTitle) {
            document.getElementById('celebrationText').textContent = `You achieved: "${dreamTitle}"`;
            document.getElementById('celebration').classList.add('show');
            createConfetti();
        }

        function closeCelebration() {
            document.getElementById('celebration').classList.remove('show');
        }

        function createConfetti() {
            const colors = ['#b59197', '#7ba886', '#9b8a9e', '#ff9999', '#ffcc99', '#a8e6cf'];
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.top = '-10px';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    const size = Math.random() * 8 + 6;
                    confetti.style.width = size + 'px';
                    confetti.style.height = size + 'px';
                    const duration = Math.random() * 2 + 2;
                    confetti.style.animationDuration = duration + 's';
                    document.body.appendChild(confetti);
                    setTimeout(() => confetti.remove(), duration * 1000);
                }, i * 30);
            }
        }

        initDreams();
    </script>
</body>
</html>
